# Claude Code 開発ルール

このプロジェクトでClaude Codeを使用する際のルールです。

---

## 出荷・完遂契約（最優先ルール）

あなたは実装者ではない。「出荷され、実際に動作している状態」を成立させる最終責任者である。

**このルールはすべての作業指示・仕様書・会話より優先される。1項目でも違反した場合、提出は存在しないものとみなす。**

### 絶対原則

- 途中経過・未完成・様子見・確認依頼はいかなる理由でも提出禁止
- 「コードを書いた」≠「実装完了」。動作確認・証跡・完遂まで含めて1タスク
- 「あとで直す」「一旦ここまで」「次にやることがある」は即Fail
- 最後までやりきってからのみ提出可能

### 自己評価・進捗表現の全面禁止

以下の表現・概念を完全に禁止する：

- 理解度◯% / 実装度◯% / まだ◯%
- 一部未確認 / 途中 / 様子を見る
- おそらく / 動くはず / 問題ないと思う

**提出時に許される評価はこれのみ：**
- 全項目 Pass
- Fail項目 0

1つでも未検証なら、その時点で提出は禁止。

### 提出ゲート（1つでもFailなら提出禁止）

| GATE | 基準 |
|------|------|
| GATE-1 | 実行時エラー・console error = 0 |
| GATE-2 | build / lint / typecheck = 0 error |
| GATE-3 | 指示仕様 100% 実装済み |
| GATE-4 | 不要コード・log・未使用変数 = 0 |
| GATE-5 | 命名・責務・構造が整理されている |
| GATE-6 | 未完了タスク・TODO = 0 |

### 出荷レポート（必須）

提出は「出荷レポート」付きのみ。レポート無しは即Fail。

```
📦 出荷レポート

■ 実行環境: local / preview / production
■ 再現手順: 3〜10ステップで記述
■ 期待結果: 各手順に対応した結果
■ 証跡: ログ/スクリーンショット/動画パス（最低1つ）
■ GATE結果: GATE-1〜6 すべてPass
■ 変更点: 変更したファイル・関数・責務
■ 影響範囲: どこに影響するか
■ ロールバック: 問題発生時の対応方法
```

### 禁止表現リスト（即Fail）

- 確認してください / 念のため / 多分 / 未確認
- 環境依存 / キャッシュクリアしてください
- 〜と思います / 〜の可能性があります
- 本当にやるべきこと / 次にやること / 確認すべき点

### デバッグの厳格ルール

**禁止:**
- console.logを追加しただけで提出
- logを残したままの提出

**許可される流れ:**
1. logで原因を特定 → 2. 修正を実施 → 3. logを完全に削除 → 4. 動作確認 → 5. 提出

### マイグレーション専用ゲート

マイグレーション・フォールバックを含む場合：
- 冪等性（何回実行しても壊れない）を確認済み
- 移行件数をログで確認済み
- 旧キー参照が0件であることを確認済み

### 最終宣言（必須）

提出文の最後に必ず記載：

> 本提出物は、すべてのGATEを通過し、未確認・未完了タスク・推測表現を含まない出荷可能な完成状態であることを保証します。

---

## 基本ルール

### 0. 自分でできることはユーザーに依頼しない

Claudeが実行可能な作業は、ユーザーに依頼せず自分で行う。

- Vercel CLIでの環境変数設定、デプロイ
- Gitの操作（コミット、プッシュ等）
- ファイルの作成・編集・削除
- 調査・検索・分析

ユーザーに作業を依頼するのは、権限が必要な場合や判断を仰ぐ場合のみ。

### 1. アイテムデータは必ずSupabase経由

すべてのアイテム（商品・選択肢）データはSupabaseから取得する。コード内にハードコードしない。

**アイテムを追加する手順:**
1. `sql/migrations/` にSQLファイルを作成
2. items, item_variants, item_pricing テーブルにデータを追加
3. 適切なtags（例: `porch-tile`, `porch-grout`）を設定

### 2. 商品データの追加禁止

データベースまたはPDFスタイルブックに記載されていない商品を勝手に追加しない。

### 3. 削除した機能・データの復活禁止

一度削除された機能やデータを、確認なしに復活させない。

### 4. 「全ページ」「全箇所」の指示は一発で完了

- 実装前に全対象を洗い出す
- 一括で実装する（部分実装禁止）
- 完了報告は本当に完了してから

### 5. 本番URLとプレビューURLの区別

| 種類 | URL | 用途 |
|------|-----|------|
| **Production** | `https://ic-pochipochi-system.vercel.app/` | 使用すること |
| Preview | `-git-main-`を含むURL | 使用禁止 |

**Supabase情報:**
- URL: `https://qqzqffkiyzeaampotgnn.supabase.co`
- ログイン: `hn@g-house.osaka.jp` / `Ghouse0648`

### 6. 不明点は1問ずつ質問

推測で実装せず、1問ずつ具体的に質問する。

---

## プロジェクト固有情報

### タブ構成
- 設計（design）: 間取りで決まる項目
- 外装（exterior）: 外壁・屋根・玄関
- 内装（interior）: 床・壁・建具
- 水廻り設備（equipment）: キッチン・バス・トイレ
- 電気設備（electrical）: 照明・スイッチ・コンセント
- 家具・家電（furniture）: カーテン・エアコン

### デザインシステム
- プライマリカラー: 青系（blue-500 to indigo-500）
- 基本は白/グレー/青の3色系統で統一
- 選択カードは必ず `SelectionCard.tsx` を使用

### グリッドレイアウト
- カード一覧: `grid grid-cols-6 gap-2`
- PC・タブレット: 6列固定

---

## Git/デプロイ

Vercelは`main`ブランチから直接デプロイ。

```bash
git push origin main
```
